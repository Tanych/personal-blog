---
layout: post
title: Windows Vista Wireless Connection Doesn’t Reconnect After Hibernate
created: 1249354174
section-type: post
---
<p>This weekend I had quite a bit of trouble debugging a problem with my fiancé's laptop. It seems that every time the laptop would attempt to resume from hibernate mode, the laptop would either take a very long time to connect, or more recently connect to our wireless network SSID, showing “Local Only” access. (instead of “Local and Internet”)</p>  <p>In my quest to solve this connection problem, I found a several posts of people having similar issues, and I followed along with several of them. <a href="http://www.home-network-help.com/access-local-only.html" target="_blank">This article</a> seemed to indicate my exact problem, and I was seeing the exact same super-net (opposite of subnet?) address when I ran ipconfig from the command line. Unfortunately any combination of changing the keys in the registry as indicated only made my problem worse. (without creating / modifying registry settings, the connection would come up after a restart, with these changes applied, I would never get web access and only got the “Local Only” connection.) Another option he mentions is to try and change the power management settings on the device properties dialog from the Device Manager. In my case, on the Dell Inspiron 1520 laptop and accompanying driver, there was no “Power Management” tab available. Also, I was able to disable IPv6 in that I saw no IPv6 address using “ipconfig /all”, however this too did not help my specific problem.</p>  <p>After following all of the above steps with no luck, I turned to Gina Trapani’s guide: <a href="http://lifehacker.com/5319976/how-to-troubleshoot-a-flaky-internet-connection" target="_blank">How to Troubleshoot a Flaky Internet Connection</a>. Scenario 3 was my case, but unfortunately, neither disabling the firewall nor the AV (non-existent) software helped.</p>  <p>After most of a weekend (off and on) spent on this problem, I finally figured out a solution. On one of the previous sites mentioned, or one of the numerous forums one can find on the subject by doing a web search, I found a mention of removing (uninstalling) the network adapter from the Device Manager in windows, then restarting so that the machine will automatically install the adapter. In my particular case, when I clicked “Uninstall” from the network adapter in Device Manager, I saw a dialog asking if I was sure I wanted to remove the network adapter, and there was also a check box asking if I wanted to remove the driver software as well. (I’m sorry I don’t have a screenshot, I didn’t think this would actually solve my problem) On my first attempt, I left the check box un-checked, and as expected upon restarting Vista recognized the adapter and associated the same driver with the hardware. After this, I put the computer into Hibernate mode, pulled it out of hibernate mode, and the same problem persisted.</p>  <p>On a whim, (after pursuing other options to no avail) I decided to try and uninstall the device from Device Manager again, only this time I would check the check box to remove the driver software from the computer. The reason I didn’t do this the first time was because I thought that without driver software, there would be nothing to run the wireless antennae in the laptop, and thus no internet connection. However, I noticed that the driver in this case was a proprietary Dell driver, not the one that comes default with Windows, so I had a hunch that Windows might have it’s own default driver that would work just as well, if not better. (also, I had a wired connection ready in case I needed to re-download and install from Dell’s website) After uninstalling the adapter this second time, the restart found the device again as expected, and this time a different driver was associated with the card, and the Resume from Hibernate started the network adapter very quickly. I don’t want to celebrate too fully yet as I’ve only fixed the connection last night, but as of a few minutes ago, the laptop had no problems reconnecting after hibernate mode. Here is a screenshot of what the device manager now shows for network adapters on the laptop:</p>  <p><a href="img/tmpDeviceManager_2.png" target="_blank"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tmpDeviceManager" border="0" alt="tmpDeviceManager" src="/img/tmpDeviceManager_thumb.png" width="359" height="258" /></a> </p>  <p>A side-effect I suspect is a result of removing the proprietary Dell driver might be that the operating system cannot properly conserve power by using a lower power mode for the wireless antennae. I agree this may be a concern in certain circumstances. However, my fiancé's typical usage is to get online to check the weather, or her email, or some other online resource. So, conserving power by not powering up the wireless antennae isn’t an ideal solution in this case. If battery life becomes an issue I may have to re-evaluate, but right now, the primary problem was to make the wireless connection work again, and so far, it has.</p>
